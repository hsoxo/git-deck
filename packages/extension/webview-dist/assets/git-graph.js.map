{"version":3,"file":"git-graph.js","sources":["../../src/utils/vscodeApi.ts","../../src/components/GitGraph/GitGraphToolbar.tsx","../../src/components/GitGraph/GitGraphCommitRow.tsx","../../src/components/GitGraph/GitGraphCommitList.tsx","../../src/components/GitGraph/GitGraphContextMenu.tsx","../../src/components/GitGraph/useGitGraphLogic.ts","../../src/components/GitGraph/GitGraphView.tsx","../../src/git-graph.tsx"],"sourcesContent":["// VS Code API can only be acquired once per webview\n// Store it at window level to ensure it works across module reloads\ndeclare global {\n    interface Window {\n        __vscodeApi?: any;\n    }\n}\n\nexport function getVsCodeApi() {\n    // Check if we already have the API stored on window\n    if (window.__vscodeApi) {\n        return window.__vscodeApi;\n    }\n\n    // Try to acquire it\n    const acquireVsCodeApi = (window as any).acquireVsCodeApi;\n    if (acquireVsCodeApi) {\n        try {\n            window.__vscodeApi = acquireVsCodeApi();\n        } catch (error) {\n            // If it was already acquired, it might be stored elsewhere\n            // In VS Code, after acquisition, the API is available but acquireVsCodeApi throws\n            console.warn('[vscodeApi] Failed to acquire, checking if already available:', error);\n\n            // The API might already be on window from a previous call\n            if (window.__vscodeApi) {\n                return window.__vscodeApi;\n            }\n\n            throw error;\n        }\n    }\n\n    return window.__vscodeApi;\n}\n","import { memo } from 'react';\nimport type { BranchInfo } from '@git-gui/shared';\nimport './GitGraphToolbar.css';\n\nexport interface GitGraphToolbarProps {\n    branches: BranchInfo[];\n    currentBranch: string | null;\n    selectedBranch: string;\n    onRefresh: () => void;\n    onBranchChange: (branch: string) => void;\n    onCheckout: () => void;\n    onMerge: () => void;\n    onRebase: () => void;\n}\n\nexport const GitGraphToolbar = memo(function GitGraphToolbar({\n    branches,\n    currentBranch,\n    selectedBranch,\n    onRefresh,\n    onBranchChange,\n    onCheckout,\n    onMerge,\n    onRebase,\n}: GitGraphToolbarProps) {\n    return (\n        <div className=\"git-graph-toolbar\">\n            <button onClick={onRefresh} className=\"toolbar-button\">\n                Refresh\n            </button>\n\n            <select\n                className=\"branch-selector\"\n                value={selectedBranch}\n                onChange={(e) => onBranchChange(e.target.value)}\n            >\n                {branches.map((branch) => (\n                    <option key={branch.name} value={branch.name}>\n                        {branch.name}\n                        {branch.name === currentBranch ? ' (current)' : ''}\n                    </option>\n                ))}\n            </select>\n\n            <button onClick={onCheckout} className=\"toolbar-button\">\n                Checkout\n            </button>\n\n            <button onClick={onMerge} className=\"toolbar-button\">\n                Merge\n            </button>\n\n            <button onClick={onRebase} className=\"toolbar-button\">\n                Rebase\n            </button>\n        </div>\n    );\n});\n","import { memo, useCallback } from 'react';\nimport type { CommitNode } from '@git-gui/shared';\nimport './GitGraphCommitRow.css';\n\nexport interface GitGraphCommitRowProps {\n    commit: CommitNode;\n    currentBranch: string | null;\n    onContextMenu: (e: React.MouseEvent, hash: string) => void;\n    style?: React.CSSProperties;\n}\n\nexport const GitGraphCommitRow = memo(function GitGraphCommitRow({\n    commit,\n    currentBranch,\n    onContextMenu,\n    style,\n}: GitGraphCommitRowProps) {\n    // 解析 refs 为分支和标签\n    const branches: string[] = [];\n    const tags: string[] = [];\n\n    commit.refs?.forEach(ref => {\n        if (ref.includes('tag:')) {\n            // 提取标签名\n            const tagName = ref.replace('tag:', '').trim();\n            tags.push(tagName);\n        } else {\n            // 分支引用\n            branches.push(ref);\n        }\n    });\n\n    const isCurrentBranch = branches.some(b =>\n        b.includes(`HEAD -> ${currentBranch}`) ||\n        b === currentBranch\n    );\n\n    const graphDisplay = commit.graph || '* ';\n\n    const handleContextMenu = useCallback((e: React.MouseEvent) => {\n        onContextMenu(e, commit.hash);\n    }, [onContextMenu, commit.hash]);\n\n    return (\n        <div\n            className={`git-graph-commit-row ${isCurrentBranch ? 'current-branch' : ''}`}\n            data-hash={commit.hash}\n            onContextMenu={handleContextMenu}\n            style={style}\n        >\n            <div className=\"graph-column\">{graphDisplay}</div>\n\n            <div className=\"commit-info\">\n                <div className=\"commit-refs\">\n                    {/* 显示分支 */}\n                    {branches.map((ref, index) => {\n                        const isRemote = ref.includes('origin/') || ref.includes('remotes/');\n                        const displayName = ref\n                            .replace('HEAD -> ', '')\n                            .replace('origin/', '')\n                            .replace('remotes/', '')\n                            .trim();\n                        const isCurrent = ref.includes(`HEAD -> ${currentBranch}`) || ref === currentBranch;\n                        const labelClass = isCurrent ? 'current' : (isRemote ? 'remote' : 'local');\n\n                        return (\n                            <span\n                                key={`branch-${index}`}\n                                className={`branch-label ${labelClass}`}\n                                title={ref}\n                            >\n                                {displayName}\n                            </span>\n                        );\n                    })}\n\n                    {/* 显示标签 */}\n                    {tags.map((tag, index) => (\n                        <span\n                            key={`tag-${index}`}\n                            className=\"tag-label\"\n                            title={`tag: ${tag}`}\n                        >\n                            {tag}\n                        </span>\n                    ))}\n                </div>\n\n                <span className=\"commit-message\" title={commit.message}>\n                    {commit.message}\n                </span>\n\n                <span className=\"commit-hash\">\n                    {commit.hash.substring(0, 7)}\n                </span>\n\n                <span className=\"commit-author\">\n                    {commit.author_name || commit.author}\n                </span>\n\n                <span className=\"commit-date\">\n                    {new Date(commit.date).toLocaleString()}\n                </span>\n            </div>\n        </div>\n    );\n});\n","import { memo } from 'react';\nimport type { CommitNode } from '@git-gui/shared';\nimport { GitGraphCommitRow } from './GitGraphCommitRow';\nimport './GitGraphCommitList.css';\n\nexport interface GitGraphCommitListProps {\n    commits: CommitNode[];\n    currentBranch: string | null;\n    onContextMenu: (e: React.MouseEvent, hash: string) => void;\n}\n\nexport const GitGraphCommitList = memo(function GitGraphCommitList({\n    commits,\n    currentBranch,\n    onContextMenu,\n}: GitGraphCommitListProps) {\n    return (\n        <div className=\"git-graph-commit-list\">\n            {commits.map((commit) => (\n                <GitGraphCommitRow\n                    key={commit.hash}\n                    commit={commit}\n                    currentBranch={currentBranch}\n                    onContextMenu={onContextMenu}\n                />\n            ))}\n        </div>\n    );\n});\n","import { memo, useEffect, useRef } from 'react';\nimport './GitGraphContextMenu.css';\n\nexport interface GitGraphContextMenuProps {\n    x: number;\n    y: number;\n    onCherryPick: () => void;\n    onRevert: () => void;\n    onCopyHash: () => void;\n    onClose: () => void;\n}\n\nexport const GitGraphContextMenu = memo(function GitGraphContextMenu({\n    x,\n    y,\n    onCherryPick,\n    onRevert,\n    onCopyHash,\n    onClose,\n}: GitGraphContextMenuProps) {\n    const menuRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n        const handleClickOutside = (e: MouseEvent) => {\n            if (menuRef.current && !menuRef.current.contains(e.target as Node)) {\n                onClose();\n            }\n        };\n\n        document.addEventListener('mousedown', handleClickOutside);\n        return () => {\n            document.removeEventListener('mousedown', handleClickOutside);\n        };\n    }, [onClose]);\n\n    return (\n        <div\n            ref={menuRef}\n            className=\"git-graph-context-menu\"\n            style={{ left: `${x}px`, top: `${y}px` }}\n        >\n            <div className=\"context-menu-item\" onClick={onCherryPick}>\n                Cherry-pick\n            </div>\n            <div className=\"context-menu-item\" onClick={onRevert}>\n                Revert\n            </div>\n            <div className=\"context-menu-item\" onClick={onCopyHash}>\n                Copy Hash\n            </div>\n        </div>\n    );\n});\n","import { useState, useEffect, useCallback } from 'react';\nimport type { CommitNode, BranchInfo, TagInfo } from '@git-gui/shared';\nimport type { GitGraphViewProps } from './GitGraphView';\nimport { getVsCodeApi } from '../../utils/vscodeApi';\n\ninterface ContextMenuState {\n    x: number;\n    y: number;\n    hash: string;\n}\n\nexport function useGitGraphLogic(props: GitGraphViewProps) {\n    const [commits, setCommits] = useState<CommitNode[]>([]);\n    const [branches, setBranches] = useState<BranchInfo[]>([]);\n    const [tags, setTags] = useState<TagInfo[]>([]);\n    const [currentBranch, setCurrentBranch] = useState<string | null>(null);\n    const [selectedBranch, setSelectedBranch] = useState<string>('');\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n    const [contextMenu, setContextMenu] = useState<ContextMenuState | null>(null);\n\n    // 获取 VS Code API (safely, only once)\n    const vscode = getVsCodeApi();\n\n    // 加载数据\n    const loadData = useCallback(async () => {\n        try {\n            setLoading(true);\n            setError(null);\n\n            // 发送消息到扩展请求数据\n            vscode?.postMessage({ type: 'getGraphData' });\n        } catch (err) {\n            setError(err instanceof Error ? err.message : String(err));\n            setLoading(false);\n        }\n    }, [vscode]);\n\n    // 监听来自扩展的消息\n    useEffect(() => {\n        const handleMessage = (event: MessageEvent) => {\n            const message = event.data;\n\n            switch (message.type) {\n                case 'graphData':\n                    setCommits(message.commits || []);\n                    setBranches(message.branches || []);\n                    setTags(message.tags || []);\n                    setCurrentBranch(message.currentBranch || null);\n                    setSelectedBranch(message.currentBranch || '');\n                    setLoading(false);\n                    break;\n\n                case 'error':\n                    setError(message.message);\n                    setLoading(false);\n                    break;\n            }\n        };\n\n        window.addEventListener('message', handleMessage);\n\n        // 初始加载\n        loadData();\n\n        return () => {\n            window.removeEventListener('message', handleMessage);\n        };\n    }, [loadData]);\n\n    const handleRefresh = useCallback(() => {\n        loadData();\n        props.onRefresh?.();\n    }, [loadData, props]);\n\n    const handleBranchChange = useCallback((branch: string) => {\n        setSelectedBranch(branch);\n    }, []);\n\n    const handleCheckout = useCallback(() => {\n        if (selectedBranch) {\n            vscode?.postMessage({ type: 'checkout', branch: selectedBranch });\n            props.onCheckout?.(selectedBranch);\n        }\n    }, [selectedBranch, vscode, props]);\n\n    const handleMerge = useCallback(() => {\n        if (selectedBranch) {\n            vscode?.postMessage({ type: 'merge', branch: selectedBranch });\n            props.onMerge?.(selectedBranch);\n        }\n    }, [selectedBranch, vscode, props]);\n\n    const handleRebase = useCallback(() => {\n        if (selectedBranch) {\n            vscode?.postMessage({ type: 'rebase', branch: selectedBranch });\n            props.onRebase?.(selectedBranch);\n        }\n    }, [selectedBranch, vscode, props]);\n\n    const handleContextMenu = useCallback((e: React.MouseEvent, hash: string) => {\n        e.preventDefault();\n        e.stopPropagation();\n        setContextMenu({\n            x: e.clientX,\n            y: e.clientY,\n            hash,\n        });\n    }, []);\n\n    const handleCherryPick = useCallback((hash: string) => {\n        vscode?.postMessage({ type: 'cherryPick', commits: [hash] });\n        props.onCherryPick?.([hash]);\n        setContextMenu(null);\n    }, [vscode, props]);\n\n    const handleRevert = useCallback((hash: string) => {\n        vscode?.postMessage({ type: 'revert', commit: hash });\n        props.onRevert?.(hash);\n        setContextMenu(null);\n    }, [vscode, props]);\n\n    const handleCopyHash = useCallback((hash: string) => {\n        navigator.clipboard.writeText(hash);\n        props.onCopyHash?.(hash);\n        setContextMenu(null);\n    }, [props]);\n\n    const closeContextMenu = useCallback(() => {\n        setContextMenu(null);\n    }, []);\n\n    return {\n        commits,\n        branches,\n        tags,\n        currentBranch,\n        selectedBranch,\n        loading,\n        error,\n        contextMenu,\n        handleRefresh,\n        handleBranchChange,\n        handleCheckout,\n        handleMerge,\n        handleRebase,\n        handleContextMenu,\n        handleCherryPick,\n        handleRevert,\n        handleCopyHash,\n        closeContextMenu,\n    };\n}\n","import { memo } from 'react';\nimport { GitGraphToolbar } from './GitGraphToolbar';\nimport { GitGraphCommitList } from './GitGraphCommitList';\nimport { GitGraphContextMenu } from './GitGraphContextMenu';\nimport { useGitGraphLogic } from './useGitGraphLogic';\nimport './GitGraphView.css';\n\nexport interface GitGraphViewProps {\n    onRefresh?: () => void;\n    onCheckout?: (branch: string) => void;\n    onMerge?: (branch: string) => void;\n    onRebase?: (branch: string) => void;\n    onCherryPick?: (commits: string[]) => void;\n    onRevert?: (commit: string) => void;\n    onCopyHash?: (hash: string) => void;\n}\n\nexport const GitGraphView = memo(function GitGraphView(props: GitGraphViewProps) {\n    const {\n        commits,\n        branches,\n        currentBranch,\n        loading,\n        error,\n        contextMenu,\n        selectedBranch,\n        handleRefresh,\n        handleBranchChange,\n        handleCheckout,\n        handleMerge,\n        handleRebase,\n        handleContextMenu,\n        handleCherryPick,\n        handleRevert,\n        handleCopyHash,\n        closeContextMenu,\n    } = useGitGraphLogic(props);\n\n    if (error) {\n        return (\n            <div className=\"git-graph-error\">\n                <div className=\"error-icon\">⚠️</div>\n                <h2>Failed to Load Git Graph</h2>\n                <p>{error}</p>\n                <button onClick={handleRefresh}>Retry</button>\n            </div>\n        );\n    }\n\n    if (loading && commits.length === 0) {\n        return (\n            <div className=\"git-graph-loading\">\n                <div className=\"loading-spinner\"></div>\n                <p>Loading git graph...</p>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"git-graph-view\" onClick={closeContextMenu}>\n            <GitGraphToolbar\n                branches={branches}\n                currentBranch={currentBranch}\n                selectedBranch={selectedBranch}\n                onRefresh={handleRefresh}\n                onBranchChange={handleBranchChange}\n                onCheckout={handleCheckout}\n                onMerge={handleMerge}\n                onRebase={handleRebase}\n            />\n\n            <GitGraphCommitList\n                commits={commits}\n                currentBranch={currentBranch}\n                onContextMenu={handleContextMenu}\n            />\n\n            {contextMenu && (\n                <GitGraphContextMenu\n                    x={contextMenu.x}\n                    y={contextMenu.y}\n                    onCherryPick={() => handleCherryPick(contextMenu.hash)}\n                    onRevert={() => handleRevert(contextMenu.hash)}\n                    onCopyHash={() => handleCopyHash(contextMenu.hash)}\n                    onClose={closeContextMenu}\n                />\n            )}\n        </div>\n    );\n});\n","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport { GitGraphView } from './components/GitGraph/GitGraphView';\nimport './index.css';\n\n// IMPORTANT: Acquire VS Code API immediately at module level\n// This must happen before any other code that might try to acquire it\nimport { getVsCodeApi } from './utils/vscodeApi';\ngetVsCodeApi(); // Call it immediately to cache it\n\nconsole.log('[Git Graph] Starting initialization...');\n\ntry {\n    const rootElement = document.getElementById('root');\n    if (!rootElement) {\n        throw new Error('Root element not found');\n    }\n\n    console.log('[Git Graph] Creating React root...');\n    const root = ReactDOM.createRoot(rootElement);\n\n    console.log('[Git Graph] Rendering GitGraphView component...');\n    root.render(\n        <React.StrictMode>\n            <GitGraphView />\n        </React.StrictMode>\n    );\n\n    console.log('[Git Graph] GitGraphView rendered successfully');\n} catch (error) {\n    console.error('[Git Graph] Initialization error:', error);\n}\n"],"names":["memo","GitGraphToolbar","jsxs","jsx","GitGraphCommitRow","useCallback","GitGraphCommitList","GitGraphContextMenu","useRef","useEffect","useState","GitGraphView","ReactDOM"],"mappings":"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"}